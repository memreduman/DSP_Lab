% FIR_COEFFS.M
% MATLAB function to write FIR filter coefficients
% in format suitable for use in DSP LiB programs
% fir_intr.c and fir_prbs_intr.c
% written by Donald Reay
%

%function fir_coeffs(coeff)

coeff = [0.000630447178089792 -0.00400830363457713 ...
        0.0094327507415814 -0.0100793203383498 0.00172860794373274 ...
        0.00614040355487584 -0.00217596220606626 -0.0056100157487969 ...
        0.00179762524781396 0.00631585095156953 -0.00123940840335718 ...
        -0.00758959142805486 0.000379032838215427 0.00925025686244555 ...
        0.000934117357063215 -0.0111832848867292 -0.00290984017309027 ...
        0.0133256026199124 0.00576699818586685 -0.0155904415706014 ...
        -0.00980035877588581 0.0178699516151147 0.0154721365008409 ...
        -0.02006125684905 -0.0235790370473612 0.0220545858524501 ...
        0.0357901077315959 -0.023742856761068 -0.0564557575951256 ...
        0.0250286240090282 0.101658080163773 -0.0258320685727033 ...
        -0.316807211998383 0.526105051535348 -0.316807211998383 ...
        -0.0258320685727033 0.101658080163773 0.0250286240090282 ...
        -0.0564557575951256 -0.023742856761068 0.0357901077315959 ...
        0.0220545858524501 -0.0235790370473612 -0.02006125684905 ...
        0.0154721365008409 0.0178699516151147 -0.00980035877588581 ...
        -0.0155904415706014 0.00576699818586685 0.0133256026199124 ...
        -0.00290984017309027 -0.0111832848867292 0.000934117357063215 ...
        0.00925025686244555 0.000379032838215427 -0.00758959142805486 ...
        -0.00123940840335718 0.00631585095156953 0.00179762524781396 ...
        -0.0056100157487969 -0.00217596220606626 0.00614040355487584 ...
        0.00172860794373274 -0.0100793203383498 0.0094327507415814 ...
        -0.00400830363457713 0.000630447178089792];



coefflen=length(coeff);
fname = input('enter filename for coefficients ','s');
fid = fopen(fname,'wt');
fprintf(fid,'// %s\n',fname);
fprintf(fid,'// this file was generated using ');
fprintf(fid,'function fir_coeffs.m\n');
fprintf(fid,'\n#define N %d\n',coefflen);
fprintf(fid,'\nfloat32_t h[N] = { \n');
% j is used to count coefficients written to current line
% in output file
j=0;
% i is used to count through coefficients
for i=1:coefflen  
% if six coeffs have been written to current line
% then start new line
  if j>5    
    j=0; 
    fprintf(fid,'\n');  
  end  
% if this is the last coefficient then simply write
% its value to the current line
% else write coefficient value, followed by comma
  if i==coefflen
   fprintf(fid,'%2.4E',coeff(i));
  else
    fprintf(fid,'%2.4E,',coeff(i));  
    j=j+1;
  end
end
fprintf(fid,'\n};\n');
fclose(fid);          
